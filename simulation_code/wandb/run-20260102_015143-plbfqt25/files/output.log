
============================================================
Starting ReinFlow Training (PPO, Parallel)
============================================================
Instruction: 'pick up the block'
Parallel environments: 10
Chunks per episode: 3
Denoising steps: 1
Policy LR: 5e-06 -> 5.000000000000001e-07
Critic LR: 0.0003 -> 2.9999999999999997e-05
LR warmup iterations: 10
PPO epochs: 10
Mini-batch size: 8
Gradient accumulation: 15
Effective batch size: 120
Clip epsilon: 0.0005
GAE lambda: 0.95
Target KL: 100.0
Entropy coeff: 0.0
Critic warmup iters: 2
Training mode: PPO ON-POLICY
============================================================


[Critic Warmup] Training critic for 2 iterations...
/tmp/as4487/SO-ARM-101/simulation_code/so101_mujoco_utils.py:435: UserWarning: Preprocessor failed, using identity normalization: 'task'
  warnings.warn(f"Preprocessor failed, using identity normalization: {e}")
  [Warmup 1/2] Critic loss: 7501.1250
  [Warmup 2/2] Critic loss: 7071.3813
[Critic Warmup] Complete!

  [KL Early Stop] Epoch 1, KL=303228256.0000 > 150.0000
Batch    1 (   10 eps) | Reward:  -60.44 | KL: 303228256.0000 | LR: 9.50e-07 | Time: 2.7s
  [KL Early Stop] Epoch 1, KL=60731376.0000 > 150.0000
Batch    2 (   20 eps) | Reward:  -61.68 | KL: 60731376.0000 | LR: 1.40e-06 | Time: 2.5s
[ReinFlow] Checkpoint saved to reinflow_checkpoint.pt
  [KL Early Stop] Epoch 1, KL=320451456.0000 > 150.0000
Batch    3 (   30 eps) | Reward:  -62.14 | KL: 320451456.0000 | LR: 1.85e-06 | Time: 2.5s
  [KL Early Stop] Epoch 1, KL=363878752.0000 > 150.0000
Batch    4 (   40 eps) | Reward:  -60.66 | KL: 363878752.0000 | LR: 2.30e-06 | Time: 2.5s
[ReinFlow] Checkpoint saved to reinflow_checkpoint.pt
  [KL Early Stop] Epoch 1, KL=181936960.0000 > 150.0000
Batch    5 (   50 eps) | Reward:  -60.24 | KL: 181936960.0000 | LR: 2.75e-06 | Time: 2.5s
  [KL Early Stop] Epoch 1, KL=190290000.0000 > 150.0000
Batch    6 (   60 eps) | Reward:  -60.98 | KL: 190290000.0000 | LR: 3.20e-06 | Time: 2.5s
[ReinFlow] Checkpoint saved to reinflow_checkpoint.pt
  [KL Early Stop] Epoch 1, KL=363873888.0000 > 150.0000
Batch    7 (   70 eps) | Reward:  -62.96 | KL: 363873888.0000 | LR: 3.65e-06 | Time: 2.5s
  [KL Early Stop] Epoch 1, KL=303228224.0000 > 150.0000
Batch    8 (   80 eps) | Reward:  -58.94 | KL: 303228224.0000 | LR: 4.10e-06 | Time: 2.5s
[ReinFlow] Checkpoint saved to reinflow_checkpoint.pt
  [KL Early Stop] Epoch 1, KL=181936960.0000 > 150.0000
Batch    9 (   90 eps) | Reward:  -62.08 | KL: 181936960.0000 | LR: 4.55e-06 | Time: 2.5s
  [KL Early Stop] Epoch 1, KL=242582656.0000 > 150.0000
Batch   10 (  100 eps) | Reward:  -60.66 | KL: 242582656.0000 | LR: 5.00e-06 | Time: 2.5s
[ReinFlow] Checkpoint saved to reinflow_checkpoint.pt
  [KL Early Stop] Epoch 1, KL=242582608.0000 > 150.0000
Batch   11 (  110 eps) | Reward:  -60.82 | KL: 242582608.0000 | LR: 5.00e-06 | Time: 2.5s
  [KL Early Stop] Epoch 1, KL=485165184.0000 > 150.0000
Batch   12 (  120 eps) | Reward:  -62.44 | KL: 485165184.0000 | LR: 5.00e-06 | Time: 2.5s
[ReinFlow] Checkpoint saved to reinflow_checkpoint.pt
  [KL Early Stop] Epoch 1, KL=363873888.0000 > 150.0000
Batch   13 (  130 eps) | Reward:  -62.24 | KL: 363873888.0000 | LR: 5.00e-06 | Time: 2.5s


Training interrupted by user.
